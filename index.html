<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Feedback App</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.22.5/babel.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    }

    body {
      transition: background-color 0.3s, color 0.3s;
    }

    .light {
      --bg-color: #f5f7fa;
      --card-bg: #ffffff;
      --text-color: #333333;
      --border-color: #e1e4e8;
      --primary-color: #2563eb;
      --primary-hover: #1d4ed8;
      --secondary-color: #64748b;
      --danger-color: #ef4444;
      --danger-hover: #dc2626;
      --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      background-color: var(--bg-color);
      color: var(--text-color);
      min-height: 100vh;
    }

    .dark {
      --bg-color: #1a1a2e;
      --card-bg: #262641;
      --text-color: #e2e8f0;
      --border-color: #374151;
      --primary-color: #3b82f6;
      --primary-hover: #60a5fa;
      --secondary-color: #94a3b8;
      --danger-color: #f87171;
      --danger-hover: #fb7185;
      --shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
      background-color: var(--bg-color);
      color: var(--text-color);
      min-height: 100vh;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
      padding: 2rem 1rem;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2rem;
    }

    .logo {
      font-size: 1.8rem;
      font-weight: bold;
      color: var(--primary-color);
    }

    .theme-toggle {
      background: none;
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
      padding: 0.5rem;
      border-radius: 50%;
      background-color: var(--card-bg);
      color: var(--text-color);
      box-shadow: var(--shadow);
      width: 40px;
      height: 40px;
      transition: all 0.3s;
    }

    .theme-toggle:hover {
      transform: translateY(-2px);
    }

    .card {
      background-color: var(--card-bg);
      border-radius: 8px;
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      box-shadow: var(--shadow);
      border: 1px solid var(--border-color);
    }

    .card-title {
      font-size: 1.25rem;
      font-weight: 600;
      margin-bottom: 1rem;
      color: var(--primary-color);
    }

    .form-group {
      margin-bottom: 1rem;
    }

    .form-label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 500;
    }

    .form-input, .form-textarea {
      width: 100%;
      padding: 0.75rem;
      border-radius: 6px;
      border: 1px solid var(--border-color);
      background-color: var(--card-bg);
      color: var(--text-color);
      font-size: 1rem;
      transition: border-color 0.3s;
    }

    .form-input:focus, .form-textarea:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3);
    }

    .form-textarea {
      min-height: 100px;
      resize: vertical;
    }

    .btn {
      display: inline-block;
      padding: 0.75rem 1.5rem;
      border-radius: 6px;
      font-size: 1rem;
      font-weight: 500;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s;
      border: none;
    }

    .btn-primary {
      background-color: var(--primary-color);
      color: white;
    }

    .btn-primary:hover {
      background-color: var(--primary-hover);
      transform: translateY(-2px);
    }

    .btn-danger {
      background-color: var(--danger-color);
      color: white;
    }

    .btn-danger:hover {
      background-color: var(--danger-hover);
      transform: translateY(-2px);
    }

    .feedback-item {
      padding: 1.25rem;
      border-radius: 8px;
      background-color: var(--card-bg);
      margin-bottom: 1rem;
      border: 1px solid var(--border-color);
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
    }

    .feedback-content {
      flex: 1;
    }

    .feedback-name {
      font-size: 1.1rem;
      font-weight: 600;
      margin-bottom: 0.25rem;
      color: var(--primary-color);
    }

    .feedback-rating {
      display: flex;
      align-items: center;
      margin: 0.5rem 0;
      color: gold;
    }

    .feedback-message {
      margin-top: 0.5rem;
      color: var(--text-color);
    }

    .feedback-buttons {
      margin-left: 1rem;
    }

    .btn-sm {
      padding: 0.4rem 0.8rem;
      font-size: 0.875rem;
    }

    .empty-list {
      text-align: center;
      padding: 2rem;
      color: var(--secondary-color);
      font-style: italic;
    }

    .feedback-count {
      margin-bottom: 1rem;
      color: var(--secondary-color);
      font-size: 0.9rem;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    // ThemeToggle Component
    const ThemeToggle = ({ onToggle, currentTheme }) => {
      return (
        <button onClick={onToggle} className="theme-toggle" title="Toggle theme">
          {currentTheme === 'light' ? 'üåô' : '‚òÄÔ∏è'}
        </button>
      );
    };

    // Rating Component
    const Rating = ({ rating }) => {
      return (
        <div className="feedback-rating">
          {[...Array(5)].map((_, i) => (
            <span key={i}>{i < rating ? '‚òÖ' : '‚òÜ'}</span>
          ))}
        </div>
      );
    };

    const FeedbackForm = ({ onAddFeedback }) => {
      const [name, setName] = React.useState('');
      const [rating, setRating] = React.useState(5);
      const [message, setMessage] = React.useState('');
      
      const submitHandler = (e) => {
        e.preventDefault();
        
        if (name.trim() === '' || message.trim() === '') {
          return;
        }
        
        const newFeedback = {
          name,
          rating: Number(rating),
          message,
          date: new Date().toISOString()
        };
        
        onAddFeedback(newFeedback);
        
        setName('');
        setRating(5);
        setMessage('');
      };
      
      return (
        <div className="card">
          <h2 className="card-title">Leave Your Feedback</h2>
          <form onSubmit={submitHandler}>
            <div className="form-group">
              <label htmlFor="name" className="form-label">Your Name</label>
              <input 
                type="text" 
                id="name" 
                className="form-input" 
                value={name} 
                onChange={(e) => setName(e.target.value)}
                placeholder="Enter your name"
                required
              />
            </div>
            <div className="form-group">
              <label htmlFor="rating" className="form-label">Rating</label>
              <select 
                id="rating" 
                className="form-input" 
                value={rating} 
                onChange={(e) => setRating(e.target.value)}
              >
                <option value="5">Excellent (5)</option>
                <option value="4">Very Good (4)</option>
                <option value="3">Good (3)</option>
                <option value="2">Fair (2)</option>
                <option value="1">Poor (1)</option>
              </select>
            </div>
            <div className="form-group">
              <label htmlFor="message" className="form-label">Your Message</label>
              <textarea 
                id="message" 
                className="form-textarea" 
                value={message} 
                onChange={(e) => setMessage(e.target.value)}
                placeholder="Share your thoughts..."
                required
              />
            </div>
            <button type="submit" className="btn btn-primary">Submit Feedback</button>
          </form>
        </div>
      );
    };

    const FeedbackItem = ({ feedback, onDelete }) => {
      const formatDate = (dateString) => {
        const options = { year: 'numeric', month: 'short', day: 'numeric' };
        return new Date(dateString).toLocaleDateString(undefined, options);
      };
      
      return (
        <div className="feedback-item">
          <div className="feedback-content">
            <h3 className="feedback-name">{feedback.name}</h3>
            <Rating rating={feedback.rating} />
            <div className="feedback-message">{feedback.message}</div>
            {feedback.date && <small className="feedback-date">{formatDate(feedback.date)}</small>}
          </div>
          <div className="feedback-buttons">
            <button className="btn btn-danger btn-sm" onClick={() => onDelete(feedback.id)}>
              Delete
            </button>
          </div>
        </div>
      );
    };

    const FeedbackList = ({ feedbacks, onDelete }) => {
      if (!feedbacks || feedbacks.length === 0) {
        return (
          <div className="card">
            <div className="empty-list">No feedback yet. Be the first to leave one!</div>
          </div>
        );
      }
      
      return (
        <div className="card">
          <h2 className="card-title">Recent Feedback</h2>
          <div className="feedback-count">{feedbacks.length} feedback entries</div>
          {feedbacks.map((feedback) => (
            <FeedbackItem key={feedback.id} feedback={feedback} onDelete={onDelete} />
          ))}
        </div>
      );
    };

    function App() {
      const [theme, setTheme] = React.useState(localStorage.getItem("theme") || "light");
      const [feedbacks, setFeedbacks] = React.useState([]);
      
      const fetchFeedbacks = async () => {
        try {
          const res = await fetch("https://hello-ec906-default-rtdb.firebaseio.com/feedbacks.json");
          const data = await res.json();
          const loadedFeedbacks = [];
          
          if (data) {
            for (const key in data) {
              loadedFeedbacks.push({ id: key, ...data[key] });
            }
          }
          
          setFeedbacks(loadedFeedbacks);
        } catch (error) {
          console.error("Error fetching feedback:", error);
        }
      };
      
      React.useEffect(() => {
        fetchFeedbacks();
        document.body.className = theme;
      }, [theme]);
      
      const addFeedbackHandler = async (feedback) => {
        try {
          await fetch("https://hello-ec906-default-rtdb.firebaseio.com/feedbacks.json", {
            method: "POST",
            body: JSON.stringify(feedback),
            headers: { "Content-Type": "application/json" },
          });
          fetchFeedbacks();
        } catch (error) {
          console.error("Error adding feedback:", error);
        }
      };
      
      const deleteFeedbackHandler = async (id) => {
        try {
          await fetch(`https://hello-ec906-default-rtdb.firebaseio.com/feedbacks/${id}.json`, {
            method: "DELETE",
          });
          fetchFeedbacks();
        } catch (error) {
          console.error("Error deleting feedback:", error);
        }
      };
      
      const toggleTheme = () => {
        const newTheme = theme === "light" ? "dark" : "light";
        setTheme(newTheme);
        localStorage.setItem("theme", newTheme);
        document.body.className = newTheme;
      };
      
      return (
        <div className="container">
          <header className="header">
            <h1 className="logo">Feedback App</h1>
            <ThemeToggle onToggle={toggleTheme} currentTheme={theme} />
          </header>
          <FeedbackForm onAddFeedback={addFeedbackHandler} />
          <FeedbackList feedbacks={feedbacks} onDelete={deleteFeedbackHandler} />
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById("root")).render(<App />);
  </script>
</body>
</html>